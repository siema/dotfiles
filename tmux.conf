# pass some env vars
set-option  -g  update-environment 'DISPLAY SSH_ASKPASS SSH_AGENT_PID SSH_CONNECTION WINDOWID XAUTHORITY TERM'

# set correct term colors
set-option  -g  default-terminal screen
if "[[ ${TERM} =~ 256color || ${TERM} == fbterm ]]" 'set-option -g default-terminal screen-256color'

set-option -g   default-shell /usr/bin/zsh

##### keybindings
unbind      C-b
set-option  -g  prefix C-a

bind-key    a   send-prefix
bind-key    C-a last-window
bind-key    r   source-file ~/.tmux.conf
bind-key    C-r setw automatic-rename

bind-key    -t vi-copy WheelUpPane halfpage-up
bind-key    -t vi-copy WheelDownPane halfpage-down

### vimlike navigation
set-option  -g  mode-keys vi
bind-key    h   select-pane -L
bind-key    j   select-pane -D
bind-key    k   select-pane -U
bind-key    l   select-pane -R
bind-key    H   resize-pane -L 5
bind-key    J   resize-pane -D 5
bind-key    K   resize-pane -U 5
bind-key    L   resize-pane -R 5

# vimlike copy-paste
bind-key    Escape  copy-mode
unbind      p
bind-key    p   paste-buffer

### Mac-related stuff
if 'which -s reattach-to-user-namespace' 'set-option -g default-shell /usr/local/bin/zsh'
# hook script for clipboard keybindings
if 'which -s reattach-to-user-namespace' 'set-option -g default-command "reattach-to-user-namespace -l zsh"'
# vimlike copy
if 'which -s reattach-to-user-namespace' 'unbind   -t vi-copy y'
if 'which -s reattach-to-user-namespace' 'bind-key -t vi-copy y     copy-pipe "reattach-to-user-namespace pbcopy"'
if 'which -s reattach-to-user-namespace' 'unbind   -t vi-copy Enter'
if 'which -s reattach-to-user-namespace' 'bind-key -t vi-copy Enter copy-pipe "reattach-to-user-namespace pbcopy"'
# pasting
if 'which -s reattach-to-user-namespace' 'bind-key ] run "reattach-to-user-namespace pbpaste | tmux load-buffer - && tmux paste-buffer"'
if 'which -s reattach-to-user-namespace' 'unbind p'
if 'which -s reattach-to-user-namespace' 'bind-key p run "reattach-to-user-namespace pbpaste | tmux load-buffer - && tmux paste-buffer"'
####

##### other options

# we don't want accidental exits with ctrl-d
set-environment -g 'IGNOREEOF' 2

set-option  -sg escape-time 0
set-option  -g  status-interval 1
set-option  -g  base-index 1
set-option  -g  pane-base-index 1

setw        -g  mouse on

set-option  -ga terminal-override ',rxvt-uni*:XT:Ms=\E]52;%p1%s;%p2%s\007'
set-option  -g  history-limit 65535

setw        -g  monitor-activity off
setw        -g  automatic-rename
set-option  -g  set-titles on
set-option  -g  set-titles-string '[#{session_name}:#{window_index} #{host_short}] #{window_name}'

##### statusbar
# Powerline arrows:    
set-option  -g  status-left-length 20
set-option  -g  status-left '#[fg=#{?client_prefix,colour18,colour7},bg=#{?client_prefix,colour2,colour19},#{?client_prefix,bold,nobold}] [#S] #[fg=#{?client_prefix,colour2,colour19},bg=colour18,noreverse,nobold]#[default] '
set-option  -g  status-right-length 60
set-option  -g  status-right ' #[fg=colour19,bg=colour18]#[fg=colour7,bg=colour19] #{host_short} #[fg=colour18,bg=colour19]#[fg=colour19,bg=colour18] #[fg=colour7,bg=colour19] %H:%M #[fg=colour18,bg=colour19]#[fg=colour19,bg=colour18] #[fg=colour7,bg=colour19] %d-%b-%y '
set-option  -g  window-status-format '#[fg=colour18,bg=colour19]#[fg=colour7,bg=colour19] #I:#W #[fg=colour19,bg=colour18]'
set-option  -g  window-status-current-format '#[fg=colour18,bg=colour2]#[fg=colour18,bg=colour2,bold] #I:#W #[fg=colour2,bg=colour18,nobold]'

##### colors
set-option  -g  status-fg colour7
set-option  -g  status-bg colour18
setw        -g  window-status-fg colour7 
setw        -g  window-status-bg colour18 
setw        -g  window-status-current-fg colour2
setw        -g  window-status-current-bg colour18

# List of plugins
set -g @plugin 'tmux-plugins/tpm'

set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'nhdaly/tmux-scroll-copy-mode'

# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'git@github.com/user/plugin'
# set -g @plugin 'git@bitbucket.com/user/plugin'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

